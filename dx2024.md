# sql注入常见类型

```
1、联合查询注入；2、时间延迟注入；3、布尔盲注；4、报错注入；5、堆叠注入；6、二次注入；7、宽字节注入
```



# csrf和ssrf的区别

```
先把csrf和ssrf的漏洞原理说了，再说区别。csrf是针对的客户端，主要是利用用户的cookie实现攻击。ssrf针对的是服务端，调用另一台服务器资源
```



# ssrf的修复建议

```
1、过滤请求协议，只允许http或https协议；2、严格限制访问的IP和端口，只允许特定的；3、设置统一的报错信息
```



# 说几个xss的攻击payload

```
<script>alert(123)</script>；<img src=1 onerror=alert(1);><div onclick="alert(1)">
<img src=x  onclick="alert(1)">
<body  onload=alert(1)>
<img src=x onmouseover="alert(1)">
```



# web登录界面被爆破了，如何判断爆破登录成功

```
可以看响应状态码是否是200，或者看响应包是否返回登录成功或者success字样
```



# 报错注入函数

```
updatexml（）；extract value（）；floor（）；exp（）一共有10多个就说常用的这几种
```



# shiro550的流量特征

```
1、包内会包含序列化数据，一般是二进制或者是base64编码的字符串；2、数据包中会有攻击者的恶意代码或命令，类似执行shell命令，访问敏感数据；3、数据包可能使用了加密或者签名进行伪装
```



# webshell管理工具的流量特征(冰蝎/蚁剑/哥斯拉）

```
【蚁剑】
1、请求体都存在以@ini_set("display_errors","0");@set_time_limit(0)开头；2、并且响应体的返回结果是base64编码发混淆字符，格式为：随机数 结果 随机数；3、还有一个比较明显的特征，即为参数名大多以“_0x.....=”。
【冰蝎3.0】
1、使用AES加密 + base64编码,取消了2.0的动态获取密钥，使用固定的连接密钥；2、有十几种ua头来回变换；3、content-type字段常见为application/octet-stream。
【冰蝎4.0】
1、内置了十几个User-Agent头，每次请求时会随机选择其中的一个；2、每次连接使用本地端口在49700左右(就是比较大的端口)，每连接一次，每建立一次新的连接，端口就依次增加；3、请求头和响应头里会带有 Connection：Keep-Alive。
【哥斯拉】
1、在默认脚本编码的情况下，jsp会出现xc、pass字符和Java反射(ClassLoader，getClass().getClassLoader())，base64加解码等特征；2、Cookie中有一个非常关键的特征，最后会有个分号
不要照着读！！！
```



# 文件上传告警，如何判断是运维业务还是真实攻击

```
1、看上传的请求包的内容，看文件内容是否异常，对文件进行具体分析，如果判断不出来可用云沙箱监测；2、可对此条告警进行筛选看近30天内是否有产生过一样告警
```



# 常见的中间件漏洞

```
【iis】
1、目录遍历漏洞；2、iis6.0PUT文件上传漏洞；3、iis短文件名解析漏洞；4、iis远程代码执行漏洞；5、iis6.0和7.5解析漏洞。
【apache】
1、apache解析漏洞；2、apache目录遍历漏洞。
【tomcat】
1、弱口令；2、上传war包；3、PUT文件上传；4、远程代码执行。
【weblogic】
1、弱口令；2、未授权；3、上传war包；4、代码执行；5、反序列化；6、ssrf漏洞
```



# XXE漏洞可以用来做什么? 如何修复?

```
xxe漏洞可以读取任意文件、探测内网端口、攻击内网网站、发起DoS拒绝服务攻击、执行系统命令等。修复：禁用外部实体；过滤关键词例如：system、public、dtd、<!DOCTYPE、<!ENTITY等；升级xml版本
```



# 钓鱼邮件的常见话术有哪些?

```
1.“您的账户存在问题，需要尽快处理。
2.“您的包裹已经到达，请点击链接查看详情，
3.“您的订单已成功，请点击链接进行支付。
4.“您的朋友为您购买了一份礼物，请点击链接领取。
5.“您的账户已被冻结，请点击链接进行验证。”
6.“您的银行账户存在问题，请点击链接联系客服。
7.“您的快递已到，请点击链接查看配送详情。
```



# 钓鱼邮件的附件如何判断危害?

```
可将附件丢进沙箱内检测
```



# Linux和Windows的安全日志文件在什么地方

```
linux：var/log。windows：Windows/system32/winevt/log
```



# 文件读取漏洞，一般会读取哪些文件? 要是你的话会读取哪些有效文件?

```
一般会读取用户信息文件。自己的话就说读取etc/passwd、etc/shadow之类的
```



# 遇到0day怎么办，有哪些威胁情报平台

```
微步 奇安信
```



# top10漏洞

```
sql注入、xss漏洞、xxe漏洞、csrf漏洞、ssrf漏洞、代码执行命令执行漏洞、文件上传漏洞、文件包含漏洞
```



# 说一下用过的的相关产品

```
天眼、ngsoc、天擎、椒图、奇安信防火墙、青藤万象、深信服态感、绿盟sip等等
```



# Mysql和oracl在应用时的区别

```
MySQL具有轻量级、高性能和易用性高等优点，适用于中小型应用和Web开发领域；而Oracle则在企业级应用中表现得更出色，具备强大的事务处理能力、安全性和稳定性等特点。
```



# php的文件上传怎么绕过

```
前端js绕过；修改mime；大小写；双写；换行；. .；::$DATA绕过
```



# 是如何知道这个攻击是否已经成功的，攻击成功后怎么处置

```
可以先看状态码200或者500，都有可能是成功了，还有看响应包内是否有解析出来的结果。攻击成功后看具体是哪种攻击事件，根据具体的安全事件采取合适处置方案
```



# 项目中遇到需要实体排查怎么做

```
手工加工具结合
```



# 中了挖矿木马有什么特征

```
cpu爆满、运行慢，风扇异响，网络变慢，耗电量增加
```



# 文件上传防护

```
1、只允许特定文件上传；2、设置上传的目录不可解析；3、单独设置文件服务器；4、上传后文件随机数命名；5、限制上传的文件大小
```



# 怎么溯源

```
IP地址溯源是追踪攻击者的最基本方法之一。当一个攻击发生时，可以通过分析被攻击系统的日志来获取攻击者的IP地址。然后，可以使用各种工具和技术，如WHOIS查询、Traceroute等，来查找和定位该IP地址的物理位置和拥有者。这可以提供一些关于攻击者的信息，例如他们所在的国家或组织。
```



# 文件上传告警，如何判断是否是攻击行为？如果是攻击行为如何判断攻击成功？

```
1、看上传的文件内容，进行分析是否是恶意内容，2、如果成功的话响应码为200，或者响应包内有success，返回上传后的路径
```



# 挖掘过SSRF漏洞吗？一般在哪些功能点会出现这个漏洞？这个漏洞能用来做什么？

```
有挖到过，一般这种漏洞会出现在从其他服务进行资源请求时。1、通过服务器获取内网主机、端口和banner信息
2、对内网的应用程序进行攻击，比如redis、jboss
3、利用file协议读取文件
4、可以攻击内网程序造成溢出
```



# 挖掘过sql注入漏洞吗？一般你进行探测的？

```
有挖到过，一般会利用谷歌或者fofa的搜索语句去进行搜索，找到带参数的url，先进行手动尝试测试，看看是否可能存在sql漏洞。如果判断有的话，可以利用sqlmap工具去跑
```



# 盲注的函数有哪些？

```
length（）；ascii（）；substr（）；concat（）等
```



# 利用sqlmap写webshell需要具备什么前提条件

```
1、root权限；2、知道web目录；3、secure_file_priv配置为空
```



# 天眼告警：如果攻击者挂了很多层代理，你如何识别出真实IP？

```
看XFF
```



# 反序列化告警，如何判断是否成功？

```
攻击成功的特征是查看响应包内会有命令执行的相应结果
```



# shiro550反序列化的原理

```
攻击者将恶意代码进行序列化后再aes加密base64编码后发送给服务端，服务端接收到攻击者的请求后去进行base64解密aes解密然后在反向序列化的过程就执行了攻击者的恶意代码
```



# ssrf可以用来做什么

```
1、通过服务器获取内网主机、端口和banner信息
2、对内网的应用程序进行攻击，比如redis、jboss
3、利用file协议读取文件
4、可以攻击内网程序造成溢出
```



# 冰蝎的内存码有个防检测的按钮，点了之后，有什么流量特征

```
冰蝎点击防检测按钮后注入内存马时会选择内置四个jar包中任意一个实现注入内存马。
```



# fastjson反序列化，没有回显怎么判断攻击是否成功

```
可以利用dnslog检测是否有fastjson反序列化漏洞，当漏洞请求成功时会主动解析dnslog域名，dns协议的DNS_A记录中显示解析到的IP地址。以此可以判断是攻击成功，如果失败了，DNS_A则不会有任何记录。
```



# 去年护网的过程中，遇到过什么0day，可以说几个吗

```
泛微 E-Cology 某版本 SQL注入漏洞 ；
金和OA C6-GetSqlData.aspx RCE命令执行漏洞； HiKVISION 综合安防管理平台 files 任意文件上传漏洞 POC等
```



# edr检测原理

```
依据自身的情报库规则库检测库做特征检测匹配生成告警,就是探针原理
```



# ssrf用gopher协议打内网redis 服务payload

```
gopher协议后面跟上数据包
```



# xxe漏洞的危害和原理

```
外部实体注入漏洞,发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、攻击内网、发起dos攻击等危害。
```



# jsonp的原理

```
jsonp是跨域请求的方法之一，利用script标签不受同源策略限制的特性，使用callback function将数据或代码序列化为json传输到前端。（可能导致xss）
```



# 未授权的漏洞有那些

```
JBOSS未授权、redis未授权、solr未授权、spring boot actuator、weblogic未授权、zabbix未授权
Docker 未授权访问漏洞
ZooKeeper 未授权访问漏洞
```



# webshell不出网怎么利用

```
拿到webshell不出网 上传frp搭建sockets隧道利用Proxifierprox等，全局代理隧道。探测出网协议，如dns ，icmp。
```



# 反序列化漏洞怎么造成的

```
反序列化漏洞发生在当应用程序反序列化来自不受信任源的数据时，攻击者可以通过构造恶意的序列化数据来执行任意代码或进行非法操作。
```



# 如果收到很多钓鱼邮件怎么办

```
屏蔽办公区域对钓鱼邮件内容涉及站点、URL 访问
根据办公环境实际情况可以在上网行为管理、路由器、交换机上进行屏蔽
邮件内容涉及域名、IP 均都应该进行屏蔽
对访问钓鱼网站的内网 IP 进行记录，以便后续排查溯源可能的后果
屏蔽钓鱼邮件、来源邮箱域名、来源 IP
有条件的可以根据邮件内容进行屏蔽
删除还在邮件服务器未被客户端收取钓鱼邮件
处理接收到钓鱼邮件的用户
根据钓鱼邮件发件人进行日志回溯
此处除了需要排查有多少人接收到钓鱼邮件之外，还需要排查是否公司通讯录泄露。采用 TOP500 姓氏撞库发送钓鱼邮件的攻击方式相对后续防护较为简单。如果发现是使用公司通讯录顺序则需要根据通讯录的离职情况及新加入员工排查通讯录泄露时间。毕竟有针对性的社工库攻击威力要比 TOP100、TOP500 大很多
通知已接收钓鱼邮件的用户进行处理
删除钓鱼邮件
系统改密
全盘扫毒
后续：溯源、员工培训提升安全意识
```



# 出现大量告警如何判断是误报还是被攻击，如果是误报如何避免后续误报

```
需要结合告警详情看请求的内容以及响应的内容，告警是根据规则来的，根据规则去找这些特征，然后结合前后内容判断是不是攻击语法；加白策略和规则优化
```



# 同源策略是什么

```
当两个页面的协议，域名和端口都相同的时候，我们称这两个页面是同源；同源策略（英文全称 Same origin policy）是浏览器提供的一个安全功能。它限制了从同一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的重要安全机制
```



# frp代理怎么使用？流量特征是什么

```
流量特征：
    代理名"proxy_name":"http_proxy"
    "run_id":
```



# mysql提权可以通过什么方式

```
UDF提权：用户自定义函数；MOF提权：windows server 2003及以下系统每5秒会执行一次mof目录下的文件
```



# log4j漏洞原理，怎么利用，有没有复现过，如何判断流量中的log4j

```
漏洞原理：本质上为JNDI注入，当用户输入信息时，应用程序中的log4j2组件会将信息记录到日志中，并使用jndi的lookup方法去解析url，并且通过路径获取资源，并且将资源返还给log4j2组件，如果是一个.class文件，就会去执行里面的代码。
流量：会有JNDI的字样，且后面是含有恶意域名的
```



# spring boot漏洞有哪些

```
spring actuator未授权
class.classLoader类的RCE漏洞远程代码执行漏洞
Spring Framework 中的 XML 外部实体注入 XXE漏洞
Spring Data JPA SQL注入漏洞
Spring Messaging RCE漏洞远程代码执行漏洞
SPEL表达式注入漏洞
```



# weblogic有什么漏洞

```
T3协议反序列化、XMLdecoder反序列化任意文件上传、后台弱口令部署war包、ssrf
```



# Mysql如何提权

```
udf提权：导出dll文件      mof提权
```



# windows和linux的提权方式

```
windows：计划任务提权、进程迁移提权、环境变量path提权、可信任服务路径提权、内核溢出提权、烂土豆提权（令牌窃取）、绕过UAC提权
linux：SUID提权、计划任务提权、内核漏洞（脏牛）提权
```



# struts2漏洞原理

```
都是Struts2框架执行了恶意用户传进来的OGNL表达式，进行OGNL表达式注入，从而造成远程代码执行。
Struts2 052漏洞是由于XStream对用户输入的内容没有进行校验导致反序列化漏洞，从而造成远程代码执行。
```



# 绕cdn找真实IP

```
1、域名解析历史记录
2、子域名解析，主域名有可能和子域名解析到同一ip
3、空间搜索，通过找到同指纹网站判断
4、使用ssl证书寻找真实ip
5、邮箱获取真实ip，⽹站在发信的时候，会附带真实的IP地址
6、敏感文件获取真实ip，文件探针、phpinfo、网站源码、信息泄露等
7、app获取真实ip
8、通过国外dns解析ip
```



# 冰蝎3.0和4.0的差别

```
冰蝎3使用内置aes加密算法，冰蝎4可以自定义加密算法
```



# 假设天眼报的文件上传是真实的，在业务不能下线的情况下如何处理

```
1. 关闭ssh、rdp等允许远程连接的协议端口
2. 看下外联，有无可疑ip，若有对其进行封禁，或设置ip白名单，只能有所需要的ip才能访问
3. 排查下有无文件遗留，通过 webshellkiller、D 盾、河马之类的工具进行查杀
4. 查看下告警，根据告警事件点审计各类日志和流量，看看怎么打进来的进行加固
```



# 内存马的类型

```
注入型内存马、自执行型内存马、进程注入型内存马、Hook型内存马
```



# 解释什么是负载均衡

```
负载均衡通过将流量分发到多个服务器上来平衡负载。它可以基于不同的算法（如轮询、权重等）来决定哪台服务器接收请求，以确保每台服务器的负载尽可能均衡。
```



# 同源策略

```
当两个页面的协议，域名和端口都相同的时候，我们称这两个页面是同源；同源策略（英文全称 Same origin policy）是浏览器提供的一个安全功能。它限制了从同一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的重要安全机制
```



# sql注入判断是否为误报

```
业务的行为会表现为：使用select、union、version等，但只是单独的使用。
攻击的行为会很明显：也会使用select、union、sleep等，结合前后看会发现其特征，攻击行为会查询information_schema数据库，正常业务不会查询此数据库
```



# 2024年最新的漏洞有哪些？

```
CVE-2024-21338(windows提权漏洞)
```



# sqlmap写os-shell的原理

```
1.sqlmap第一步先向目标机器写入一个上传功能的webshell，然后利用上传webshell向目标机器上传一个执行系统命令功能的webshell文件
```



# 说几个常见的中间件漏洞

```
apache、iis、nginx解析漏洞
Tomcat任意文件写入（CVE-2017-12615）、Tomcat远程代码执行（CVE-2019-0232）、后台弱口令+上传war包weblogic反序列化、任意文件上传、后台弱口令
```



# 设备发现了暴力破解 如何分析是否成功

```
确定遭受了哪种类型的暴力破解，比如ssh暴力破解：22端口上具有不明地址的连接，/var/log/secure中存在大量登录失败记录
```



# 设备被写入了webshell 如何判断是否成功 

```
关注日志中是否有外部IP访问这个webshell，如果是访问了并且连接了会有webshell连接工具相关的告警
```



# 如何添加隐藏用户

```
使用net user test$ /add添加隐藏账户，然后进入注册表将administrator和隐藏账户的注册表文件导出，删除注册表信息后重新导入即可创建成功
```



# Windows入侵排查

```
检查系统账号安全、异常端口、进程、启动项、计划任务、服务、查找可疑目录和文件
```



# 同源策略和非同源策略的区别

```
同源策略是一种保护用户安全的机制，而非同源策略则是在特定场景下为了允许跨域资源交互而采取的安全机制。
```



# mysql写入shell的条件

```
root权限
有网站的绝对路径
mysql服务对网站的网络路径有写权限，secure_file_priv值为空
```



# 文件包含漏洞危害

```
敏感信息泄露（网站源码、配置文件、系统日志等）
配合上传漏洞获取Webshell（图片马等）
执行任意脚本代码（远程执行.php脚本代码）
```



# 设备发现了文件上传 如何判断是否成功

```
看告警详情，看响应码是否为200，看响应体是否返回上传路径等信息。若上传成功会有文件访问/连接行为，关注日志中是否有外部IP访问这个文件，如果是访问了并且连接了会有webshell连接工具相关的告警
```



# 怎么判断ssrf攻击成功

```
1.看返回体中是否包含敏感信息
2.检查是否有与攻击者IP地址相关的网络流量，尤其是目标服务器对外发起的网络请求
3.响应时间检查：攻击者可能会利用SSRF来扫描内部网络或执行其他耗时操作。通过检查某些请求的响应时间，可以发现异常的耗时操作，从而推断可能存在SSRF攻击
```



# xss那几种类型 那种危害最大

```
DOM型、反射型、存储型。存储型危害最大，存储型恶意js代码存储再服务器数据库中
```



# 内网隧道代理的流量特征

```
frp：代理名"proxy_name":"http_proxy"
        "run_id":
nps：有大量时间戳(参考流量分析pdf文件记忆)
```



# 黄白票据的区别

```
1.访问权限不同
黄金票据 伪造TGT,可以获取任何Kerberos服务权限 
白银票据 伪造ST,只能访问指定的服务，白银票据的权限就远不如黄金票据的权限
2.加密方式不同
黄金票据 由Kerberos的NTLM Hash加密 
白银票据 由服务账号(通常为计算机账户)NTLM Hash加密，更加隐蔽
3.认证流程不同
黄金票据 利用过程需要访问域控DC
白银票据 不经过KDC，因此白银票据日志相对于黄金票据会更少，同时白银票据的日志都在目标服务器上，域控上不会有日志
```



# 横向移动的方法有哪几种  ptk 是什么

```
pth哈希传递攻击、ptk密钥传递攻击、ptt票据传递攻击、ms14-068伪造TGT
```



# SQL注入类型

```
根据闭合符分类：数字型、字符型、搜索型
根据传参位置分类：POST型、GET型、cookie、referer、UA头、XFF
根据利用手法分类：联合查询注入、布尔盲注、时间盲注、报错注入、dnslog注入、宽字节注入、二次注入、堆叠注入
```



# 文件上传特征

```
看告警详情，看响应码是否为200，看响应体是否返回上传路径等信息。若上传成功会有文件访问/连接行为，关注日志中是否有外部IP访问这个文件，如果是访问了并且连接了会有webshell连接工具相关的告警
```



# 应急响应排查

```
账号安全、进程、端口、启动项、计划任务、服务、检查可疑目录和文件、系统日志
```



# Linux中了挖矿病毒 特征 排查

```
特征：cpu爆满、运行慢，风扇异响，网络变慢，耗电量增加
排查：查看外联和进程状态，可以发现外联矿池地址的恶意进程。排查系统启动项、计划任务、服务等，删除发现的异常启动项、计划任务、服务等，再清除挖矿程序
```



# webshell排查

```
1、入侵时间确定
通过在网站目录中发现的 Webshell 文件的创建时间，判断攻击者实施攻击的时间范围，以便后续依据此时间进行溯源分析、追踪攻击者的活动路径。
2、Web 日志分析
对访问网站的Web日志进行分析，重点关注已知的入侵时间前后的日志记录，从而寻找攻击者的攻击路径，以及所利用的漏洞。
3、漏洞分析
通过日志中发现的问题，针对攻击者活动路径，可排查网站中存在的漏洞，并进行分析。
4、漏洞复现
对已发现的漏洞进行漏洞复现，从而还原攻击者的活动路径。
5、漏洞修复
清除已发现的 Webshell 文件，并修复漏洞。为避免再次受到攻击，网站管理员应定期对网站服务器进行全面的安全检查，及时安装相关版本补丁，修复已存在的漏洞等
```





# MySQL提权 udf提权 mof提权

```
udf提权：先把dll（win）或so（linux）文件写入到mysql插件目录，执行语句调用动态库文件创建执行命令函数，调用函数执行命令即可
mof提权：利用mof目录下的文件，每分钟都会在一个特定的时间去执行一次的特性，来写入我们的cmd命令使其被带入执行。
```



# Oracle 写os_shell

```
利用命令执行函数反弹shell，DBMS_EXPORT_EXTENSION()、dbms_xmlquery.newcontext()、DBMS_JAVA_TEST.FUNCALL()
```



# SqlServer提权

```
xp_cmdshell 、沙盒提权、sp_oacreate、
```



# CS的流量特征

```
MZ标头和DOS模式异常
4444默认端口
心跳包
```



# 如何判断内网告警是否真实攻击

```
请求包的内容是否存在恶意payload，然后再根据响应包内容有执⾏成功的回显，若相应包中有对应的payload的回显，则可以判断为攻击成功，但是此时，需要判断下是否为业务系统的逻辑造成的和是否是⼯作⼈员在测试业务系统漏洞，若⼯作⼈员证实了该告警为⾃家安全ip，则认为该攻击为误报，若⾮⾃家ip且不存在逻辑因素，则可判断为内⽹攻陷
```



# 命令执行有哪些函数

```
system、exec、shell_exec、passthru
```



# 水坑攻击

```
通常来说，水坑攻击的目的是通过感染受害者的电脑，以获得对受害者公司网络的访问权
确定受害者（往往是一个特定群体）经常访问的一些网站，并在网站上部署恶意程序，当受害者访问被部署了恶意程序的网站时即会被感染
```



# webshell免杀

```
1、混淆代码：使用各种混淆技术，如字符替换、变量重命名、代码编码等，使得Webshell的代码难以被传统的安全检测系统检测到。
2、加密与解密：将Webshell的代码进行加密，并在运行时动态解密执行，使得Webshell的原始代码难以被直接识别
3、隐藏关键字：将Webshell中的关键字、函数名等进行变形或者隐藏，使得Webshell的特征难以被检测到。
4、绕过文件上传检测：利用各种文件上传漏洞绕过服务器的文件上传检测机制，将Webshell上传至服务器。
```



# 绕waf

```
脏数据、分块传输、HTTP头污染
```



# 说一次真实的溯源的事件都做了什么？

```
1. 通过 ip 定位物理位置，对 ip 进行端口扫描，进行反渗透
2. 通过社交 ID 进行追踪
3. 通过 ip 查域名、查邮箱、电话，对域名进行溯源分析
4. 如果有恶意样本，可通过分析恶意样本，看是否存在攻击者信息
5. 通过蜜罐进行反制
6. 也可以进行反钓鱼
```



# 天眼出现sql注入告警怎么办？

```
对请求包的内容进行检查，检查是否存在sql注入的利用语句，同时检查响应包内容有执行成功的回显，若相应包中存在sql注入攻击成功的回显，则可判断攻击成功。
```



# 没有回显的RCE告警如何判断成功？

```
无回显一般都使用的是dnslog外带注入，检索受害IP是否通过DNS协议解析了域名，如果成功解析了dnslog域名，则会在DNS_A字段中产生记录，根据此方法即可判断攻击成功。
```



# 应急的整体思路？

```
确定攻击事件类型，发生时间，排查发生时间前后的日志或新建的文件，检查系统账号安全、进程、端口、启动项、计划任务、服务等是否做了权限维持，清除恶意文件和后门并修复漏洞
```



# 说出你遇到过的逻辑漏洞

```
越权漏洞：越权取消购物车商品；未授权访问漏洞；业务数据篡改：购买物品修改价格等
```



# fastjsion不出网怎么打？

```
 攻击方法apache-BCEL，直接传入字节码不需要出网就可执行恶意代码但是需要引入tomcat的依赖，在实际攻击中还算是比较常见的。
```



# shiro,fastjson，log4j2反序列化攻击怎么绕过waf

```
shiro：1.HTTP请求方法随机、2.HTTP请求方法置空、3.Shiro数据包添加脏数据、4.Shiro字段添加空白字符、5.Host头域名变IP地址
fastjson：1.添加空白字符、2.Unicode/Hex编码绕过、3.结合Feature词法分析器进行混淆绕过、4.利用FastJson智能匹配进行混淆绕过
log4j2：1. 利用分隔符和多个${}绕过、2. 通过 lower 和 upper 绕过、3."::-"符号、4.Date、5.编码
```



# awvs/goby/nessus/appscan 的流量特征

```
awvs：url、请求头、请求体中有acunetix字样
nessus：url、请求头、请求体中有nessus字样
appscan：url、请求头、请求体中有appscan字样
```



# shiro绕waf

```
1、HTTP请求方法随机
2、HTTP请求方法置空
3、Shiro数据包添加脏数据
4、Shiro字段添加空白字符
5、Host头域名变IP地址
```



# 看见sql注入告警怎么判断这个漏洞是否存在

```
首先，确保天眼的检测结果是真实可信的。检查警报中提供的详细信息，包括漏洞的类型、受影响的页面或参数等。验证这些信息可以帮助您确认警报的准确性。
```



# 怎么判断钓鱼邮件

```
- 以公司某部门的名义，如安全部、综合部，使用正式的语气，内容涉及到账号和密码等敏感信息，可能带有链接地址或附件，制造紧张氛围，比如24小时内今日下班前完整账号密码修改。
- 看发件人 设备上也会报IP 上微步查一下IP是不是恶意IP 邮件的发件人和内容是不是正常的业务往来
- 附件放到沙箱里 看看是否有问题
- 有的邮件会提示你邮件由另一个邮箱代发，或者邮箱地址不是本公司的，再或者邮箱地址是qq或者163等个人邮箱的，那就更没跑了
```



# shiro里的cookie怎么判断是攻击行为

```
请求包Cookie的rememberMe中会存在AES+base64加密的一串java反序列化代码
```



# windows日志过大不好打开怎么办

```
打开Windows系统事件查看器，设置日志存储大小
```



# redis有几种getshell方式

```
1、主从复制rce
2、写ssh公钥
3、写webshell
4、写计划任务
5、CVE-2022-0543（redis沙盒逃逸绕过造成的命令执行）
```



# strus2流量特征

```
都是Struts2框架执行了恶意用户传进来的OGNL表达式，进行OGNL表达式注入，从而造成远程代码执行。
Struts2 052漏洞是由于XStream对用户输入的内容没有进行校验导致反序列化漏洞，从而造成远程代码执行。
```



# sqlmap 支持oracle os shell吗？

```
不支持
```



# 文件上传怎么绕过

```
1.绕过前端检测：禁用浏览器js 
2.绕过后端检测文件后缀：1.上传其他可执行后缀的文件、
2.上传配置文件、
3.大小写、
4.双写、
5.点、
6.空格、
7.配合中间件解析漏洞、
8.::$DATA、
9.修改MIME文件类型、
10.00截断 
3.绕过后端检测文件内容：1.修改文件头、2.上传图片马、3.二次渲染 4.逻辑层面：条件竞争
```



# SQL注入的闭合方式

```
数字型、字符型（单引 双引 括号 和他们的组合）、搜索型（%）
```



# 反序列化了解过吗，语言方面，比如php反序列化

```
序列化是将对象序列化为字符串，为了将对象再网络中传输和写入文件或数据库；反序列化则是将序列化数据转为对象
php序列化函数serialize()、反序列化函数unserialize()
java：序列化使用ObjectOutputStream类的writeObiect方法；反序列化使用ObjectInputStream类的readObiect方法
```



# php反序列化的魔法函数有哪些

```
__construct()，__destruct()，__toString()，__call()，__callStatic()，__get()，__set()， __isset()，__unset()，__sleep()，__wakeup()等
```



# web漏洞有哪些

```
SQL注入，xss,xxe,csrf,ssrf,命令执行，代码执行，文件上传，文件包含，反序列化
```



# xss绕过方式有哪些

```
大小写绕过，双写绕过，事件绕过，空格绕过，编码
```



# csrf和xss组合使用的payload

```
利用GET型CSRF，<script src='ip/vul/csrf/csrfget/csrf_get_edit.php?sex=woman&phonenum=18888899999&add=newyork&email=888999990w.com&submit=submit'> </script>
```



# pth利用原理，利用方式，利用条件

```
pth哈希传递攻击，通过获取hash，将其传递进行身份验证，无需解密hash
利用条件：
        工作组内：Windows vista之前的系统，可以使用本地管理员组内用户攻击
                          Windows vista之后的系统，只能使用administrator账户的hash进行哈希传递攻击
         域内：只能是域管理员组内的用户的hash
利用方式：cs上线后，抓取hash，内网存活扫描，横向移动
```



# weblogic反序列化的流量特征

```
xmlDecoder反序列化：传递xml数据到wls-wsat  数据包内容有bash或者dnslog字段
```



# fastjson出网攻击手段

```
构造恶意java类，内含要执行的恶意命令，如反弹shell
在vps中启动python服务器和rmi服务，放入编译好的恶意java类
向目标服务器发送payload，让服务器请求自己在vps上部署的恶意类，并解析、执行恶意命令
```



# frp是正向代理还是反向代理

```
反向代理
```



# 正向代理和反向代理的区别

```
正向代理：双向通信，双方都可以互相访问。两者必须处于同一网络环境中，要么都处于公网，要么都处于内网。正向代理的过程一般是受害机器开启监听等待攻击机器的连接
反向代理：单向通信，一般发生在公网设备和私网设备互访的情况下。此时公网设备不能访问私网设备，但是私网设备可以访问公网设备。反向代理的过程一般是攻击机器开启监听等待受害机器的连接
```



# dnslog攻击判断是误报还是真实

```
排查一下源IP是否有其他非法外联告警（一般会有多个非法请求）排查一下根据受害IP找一下其他告警日志，看能不能找到攻击发起者，并且留意一下该受害IP后续是否有非正常流量。一般是可以找到（相关IP可能发送过多个dnslog外带请求）
看下是否存在该域名解析记录，是个服务器IP的话看下是否存在服务器向该IP的连接请求
```



# fastjson如何被判断攻击成功

```
请求体中包含恶意的JNDI语句，一般是ldap或者rmi远程访问服务器资源，后续排查是否存在与该服务器ip的连接行为
```



# shiro如何被判断攻击成功

```
请求包Cookie的rememberMe中会存在AES+base64加密的一串java反序列化代码。
返回包中存在base64加密数据，该数据可作为攻击成功的判定条件
如果攻击者利用其反弹shell，还可以通过对rememberMe中的数据解码来获得反弹的ip地址
```



# 不同横行移动方法的使用前提条件

```
pth：
        工作组内：Windows vista之前的系统，可以使用本地管理员组内用户攻击
                          Windows vista之后的系统，只能使用administrator账户的hash进行哈希传递攻击
         域内：只能是域管理员组内的用户的hash
ptk：系统安装了KB2871997补丁。系统禁用NTLM时，无法使用PTH，可通过PTK攻击
ptt：传递内存中的票据或制作票据
        黄金票据：1、域名称 2、域的 SID 3、域的 KRBTGT账户的密码hash 4、伪造的用户名，可以是任意用户甚至是不存在
        白银票据：1、域名称 2、域的 SID 3、域的服务账号的密码hash 4、伪造的用户名
```



# windows和linux的敏感文件

```
windows：# 查看系统版本c:\boot.ini 

                 # 存储Windows系统初次安装的密码c:\windows\repair\sam 

                 # MySQL配置c:\ProgramFiles\mysql\my.ini 

                 # MySQL root密码c:\ProgramFiles\mysql\data\mysql\user.MYD 

                 # php 配置信息c:\windows\php.ini
linux：# 账户信息/etc/passwd

           # 账户密码文件/etc/shadow

           # PHP 配置文件/usr/local/app/php5/lib/php.ini

           # Apache 配置文件/etc/httpd/conf/httpd.conf

           # MySQL 配置文件/etc/my.conf       
```

